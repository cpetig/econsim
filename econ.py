#!/usr/bin/python3
import numpy as np
import sys
#X = np.random.normal(size=[16,18])
X = np.asarray([
[22.927,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,22.927,22.927,22.927,22.927,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-5.657,0,0,0,0,0,0,0,0,71.646,0,0,0,-0.141,0,0,0,0,0],
[0,0,0,0,0,-0.707,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,71.646,0,0,-0.141,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,-5.657,0,0,0,0,0,0,0,0,0,0,0,71.646,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,-5.657,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,-0.707,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,71.646,0,0,0,0,0,0,0,0,0,0],
[-5.657,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,71.646,0,0,0,0,0,-0.707,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,-18.668,0,0,0,0,0,0,0,0,0,0,0,0,0,0,22.927,-3.111,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,-7.071,-28.284,-17.678,-7.071,0,0,0,0,0,0,5.732,5.732,5.732,0,4.299,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,-1.061,-1.768,-0.071,-0.071,0.716,0,0,0,0,0,0,0,0,0,0,0,-0.354,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-1.414,-2.828],
[0,0,0,0,0,0,0.716,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-5.657,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.866,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5.732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4.299,4.299,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7.165,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,-1.414,-1.414,-1.414,0,8.598,0,0,0,0,0,-5.657,-4.95,-4.243,-4.243,-4.243,-4.243,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,42.988,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-70.711,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-70.711,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-70.711,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,-5.657,-5.657,0,0,0,0,0,0,0,0,0,0,0,0,-70.711,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-7.071,0,0,0,0,0,0,0,0,0,0,0,0,-14.142,0,0,-0.141,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,-0.707,-0.707,-0.707,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,-0.707,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.866],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.433,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[-16.971,0,0,0,0,0,0,0,0.716,0,0,0,0,0,0,0,0,0,-5.657,-11.314,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,-1.061,-1.768,-0.071,-0.071,0,0,0.716,0,0,0,0,0,0,0,0,0,-0.354,-1.414,-2.828,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.354,-1.414],
[0,0,0,-14.142,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-11.314,0,-0.177,0,0,0,0,0,14.329,0,0,5.732,0,0,0],
[0,0,0,0,-28.284,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.177,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-2.828,0,0,0,-11.314,-0.177,0,0,0,0,0,0,5.732,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.177,0,0,0,0,0,0,0,5.732,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-12.728,0,-2.828,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-12.728,-2.828,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,5.732,0,0,0,0,0,0,0,-2.828,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0.716,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
[0,0,0,0,0,0,0,0,0,0,0.716,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]])

P, D, Q = np.linalg.svd(X, full_matrices=False)
X_a = P @ np.diag(D) @ Q
print(np.std(X), np.std(X_a), np.std(X - X_a))
print('Is X close to X_a?', np.isclose(X, X_a).all())
print('X',X)

np.set_printoptions(precision=4, threshold=sys.maxsize,suppress=True,linewidth=sys.maxsize)
pseudoinv = Q.transpose() @ np.diag(1/D) @ P.transpose()
print("inv",pseudoinv)
test= pseudoinv @ X
print("test",test)
